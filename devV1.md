# Дневник разработки Perm Lines v1.0

## Обзор
Этот документ описывает процесс разработки веб-приложения "Пермские линии" с интеграцией в Telegram WebApp. Приложение предназначено для знакомства с культурными и историческими местами города Перми, организованными в тематические маршруты ("линии").

## Этап 1: Базовая структура и Telegram WebApp

### Интеграция с Telegram WebApp
- Создана утилита `telegramWebApp.js` для безопасного взаимодействия с Telegram WebApp API
- Реализованы функции для получения данных пользователя, инициализации веб-приложения
- Добавлены проверки на доступность Telegram WebApp API

### Структура проекта
- Настроен базовый шаблон React-приложения
- Установлены необходимые зависимости (React, React Router)
- Организована структура каталогов:
  - `components/` - переиспользуемые компоненты
  - `utils/` - вспомогательные функции
  - `styles/` - CSS-файлы
  - `data/` - данные о линиях и точках интереса

### Компонент приветствия
- Создан компонент `UserGreeting.js` для отображения приветствия пользователя
- Реализовано получение и отображение данных пользователя из Telegram
- Добавлен заголовок приложения и базовое описание

## Этап 2: Карта и интерактивные элементы

### Интеграция MapLibre GL JS
- Добавлен компонент `Map.js` с использованием MapLibre GL JS
- Настроена базовая карта с центрированием на Перми
- Добавлены элементы управления (зум, поворот)
- Реализована адаптивность карты к размерам экрана

### Первая линия маршрута
- Создан файл данных `blueLineData.js` для синей линии
- Реализовано отображение маршрута на карте в виде линии
- Добавлены маркеры для точек интереса
- Настроена анимация при переходе между точками

### Карточки точек интереса
- Разработан компонент `PointCard.js` для отображения информации о точке
- Реализована анимация появления карточки
- Добавлены разделы: история, фотографии, как добраться
- Создана система вкладок для переключения между разделами

### Аудиоплеер для аудиогидов
- Разработан компонент `AudioPlayer.js` для воспроизведения аудиогидов
- Реализован функционал воспроизведения, паузы
- Добавлено отображение прогресса и возможность перемотки
- Реализована возможность сворачивания плеера

## Дополнительные улучшения

### Оптимизация для мобильных устройств
- Улучшена адаптивная верстка для различных размеров экрана
- Оптимизированы жесты для сенсорных экранов
- Добавлена блокировка прокрутки страницы при открытии карточки

### Настройка деплоя
- Настроен автоматический деплой на GitHub Pages
- Создан скрипт для сборки и публикации приложения
- Настроен маршрут для корректной работы на поддомене

### Улучшение UX/UI
- Добавлены плавные анимации переходов между состояниями
- Реализованы индикаторы загрузки при подгрузке данных
- Улучшено отображение информации о пользователе

## Технические детали

### Ключевые библиотеки и API
- **React**: основа приложения
- **MapLibre GL JS**: карты и геопозиционирование
- **Telegram WebApp API**: интеграция с Telegram

### Структура данных
Точки интереса имеют следующую структуру:
```javascript
{
  id: "blue-1",
  title: "Название точки",
  description: "Краткое описание",
  coordinates: [longitude, latitude],
  image: "url_изображения",
  history: "Исторический текст",
  photoGallery: [
    { url: "url_фото", title: "Подпись", isHistorical: true }
  ],
  howToGet: "Информация как добраться",
  audioGuide: [
    { title: "Название аудиогида", url: "url_аудио" }
  ]
}
```

### Сложности и их решение
1. **Разворачивание на GitHub Pages** - решено через настройку homepage в package.json и использование gh-pages пакета
2. **Обработка отсутствия Telegram API** - добавлены проверки для корректной работы и за пределами Telegram
3. **Адаптивность для разных устройств** - использованы медиа-запросы и относительные единицы измерения

## Дальнейшие планы
- Добавление нескольких тематических линий (красная, зеленая)
- Улучшение боковой навигации (меню)
- Реализация полноценной интеграции с Telegram (переключение в полноэкранный режим, бэк-кнопка, главная кнопка)
- Создание системы кэширования для офлайн-работы
- Улучшение производительности на слабых устройствах 